---
import type { Videos } from "@/lib/data";
interface Props {
  video: Videos;
}

const { video } = Astro.props;
const { href, img } = video;
---

<div>
  <p>
    <a href={href} data-fancybox="video-gallery"
      ><img class="w-full aspect-video rounded-xl" alt="" src={img} /></a
    >
  </p>
</div>

<script type="module" is:inline>
  import { Fancybox } from "https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.esm.js";

  function initFancybox() {
    Fancybox.bind('[data-fancybox="gallery"]', {
      on: {
        closing: (fancybox, slide) => {
          // Prevenir el comportamiento por defecto
          return false;
        }
      },
      Hash: false
    });
  }

  // Inicializar Fancybox al cargar la página
  document.addEventListener('DOMContentLoaded', initFancybox);

  // Re-inicializar Fancybox después de la navegación
  document.addEventListener('astro:page-load', initFancybox);

  // Destruir instancias existentes antes de la navegación
  document.addEventListener('astro:before-swap', () => {
    Fancybox.close(true); // Cierra todas las instancias abiertas
    Fancybox.destroy(); // Destruye las instancias de Fancybox
  });
</script>